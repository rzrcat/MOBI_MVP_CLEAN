"use strict";(()=>{var e={};e.id=320,e.ids=[320],e.modules={85890:e=>{e.exports=require("better-sqlite3")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},11278:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>P,patchFetch:()=>I,requestAsyncStorage:()=>j,routeModule:()=>A,serverHooks:()=>w,staticGenerationAsyncStorage:()=>_});var a={};n.r(a),n.d(a,{DELETE:()=>b,GET:()=>y,POST:()=>R,PUT:()=>v});var o=n(49303),r=n(88716),s=n(60670),i=n(87070),u=n(21970),l=n(85890),d=n.n(l),m=n(63737),p=n(57745);let c=new(d())("./dev.db"),f=(0,u.t)(c);async function N(e="mabinogi_mobile"){try{return(await f.select().from(m.bQ).where((0,p.eq)(m.bQ.game,e))).map(e=>({id:e.id,name:e.name,status:e.status,population:e.population,region:e.region,maintenanceMessage:e.maintenanceMessage,maintenanceEndTime:e.maintenanceEndTime,lastChecked:e.lastChecked}))}catch(e){return console.error("서버 목록 조회 오류:",e),[{id:"1",name:"데이안",status:"online",population:30,region:"아시아"},{id:"2",name:"아이라",status:"online",population:65,region:"아시아"},{id:"3",name:"던컨",status:"busy",population:75,region:"아시아"},{id:"4",name:"알리사",status:"online",population:35,region:"아시아"},{id:"5",name:"메이븐",status:"online",population:45,region:"아시아"},{id:"6",name:"라사",status:"busy",population:70,region:"아시아"},{id:"7",name:"칼릭스",status:"online",population:50,region:"아시아"}]}}async function L(e="mabinogi_mobile"){return(await N(e)).map(e=>e.name)}let g={};function h(e){return e.headers.get("x-user-id")}async function x(){try{return await L()}catch(e){return console.error("서버 목록 가져오기 실패:",e),["데이안","아이라","던컨","알리사","메이븐","라사","칼릭스"]}}async function y(e){if("list"===e.nextUrl.searchParams.get("servers")){let e=await x();return i.NextResponse.json({servers:e})}let t=h(e);return t?i.NextResponse.json(g[t]||[]):i.NextResponse.json({error:"Unauthorized"},{status:401})}async function R(e){let t=h(e);if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{name:n,server:a}=await e.json();if(!n||!a)return i.NextResponse.json({error:"Invalid input"},{status:400});if(!(await x()).includes(a))return i.NextResponse.json({error:"Invalid server"},{status:400});if(g[t]=g[t]||[],g[t].some(e=>e.name===n&&e.server===a))return i.NextResponse.json({error:"Duplicate character"},{status:409});let o={id:Math.random().toString(36).slice(2,10),name:n,server:a};return g[t].push(o),i.NextResponse.json(o)}async function v(e){let t=h(e);if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{id:n,name:a,server:o}=await e.json();if(!n||!a||!o)return i.NextResponse.json({error:"Invalid input"},{status:400});if(!(await x()).includes(o))return i.NextResponse.json({error:"Invalid server"},{status:400});let r=g[t]||[],s=r.findIndex(e=>e.id===n);return -1===s?i.NextResponse.json({error:"Not found"},{status:404}):r.some(e=>e.id!==n&&e.name===a&&e.server===o)?i.NextResponse.json({error:"Duplicate character"},{status:409}):(r[s]={id:n,name:a,server:o},i.NextResponse.json(r[s]))}async function b(e){let t=h(e);if(!t)return i.NextResponse.json({error:"Unauthorized"},{status:401});let{id:n}=await e.json();return n?(g[t]=(g[t]||[]).filter(e=>e.id!==n),i.NextResponse.json({success:!0})):i.NextResponse.json({error:"Invalid input"},{status:400})}let A=new o.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/users/characters/route",pathname:"/api/users/characters",filename:"route",bundlePath:"app/api/users/characters/route"},resolvedPagePath:"/Users/s/Desktop/dev/mobi.gg/src/app/api/users/characters/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:j,staticGenerationAsyncStorage:_,serverHooks:w}=A,P="/api/users/characters/route";function I(){return(0,s.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:_})}},63737:(e,t,n)=>{n.d(t,{OK:()=>u,bQ:()=>d});var a=n(87106),o=n(53586),r=n(5795),s=n(54341),i=n(81347);let u=(0,a.Px)("Rune",{id:(0,o.fL)("id").primaryKey(),createdAt:(0,r._L)("createdAt",{mode:"timestamp"}).notNull(),updatedAt:(0,r._L)("updatedAt",{mode:"timestamp"}).notNull(),name:(0,o.fL)("name").notNull(),category:(0,o.fL)("category").notNull(),grade:(0,o.fL)("grade").notNull(),classes:(0,o.fL)("classes").notNull(),effect:(0,o.fL)("effect").notNull(),duration:(0,r._L)("duration"),cooldown:(0,r._L)("cooldown"),obtainMethod:(0,o.fL)("obtainMethod").notNull(),imageUrl:(0,o.fL)("imageUrl"),recommendedCombinations:(0,o.fL)("recommendedCombinations").notNull(),stats:(0,o.fL)("stats"),description:(0,o.fL)("description"),usage:(0,o.fL)("usage"),notes:(0,o.fL)("notes").notNull(),tradeable:(0,r._L)("tradeable",{mode:"boolean"}).notNull().default(!0),weight:(0,r._L)("weight"),curseRate:(0,s.kw)("curseRate"),epicAchievement:(0,o.fL)("epicAchievement")}),l=(0,a.Px)("RuneComment",{id:(0,o.fL)("id").primaryKey(),runeId:(0,o.fL)("runeId").notNull(),userId:(0,o.fL)("userId").notNull(),userName:(0,o.fL)("userName").notNull(),content:(0,o.fL)("content").notNull(),createdAt:(0,r._L)("createdAt",{mode:"timestamp"}).notNull(),updatedAt:(0,r._L)("updatedAt",{mode:"timestamp"}).notNull(),isBlinded:(0,r._L)("isBlinded",{mode:"boolean"}).notNull().default(!1),likes:(0,r._L)("likes").notNull().default(0)});(0,a.Px)("RuneGuide",{id:(0,o.fL)("id").primaryKey(),runeId:(0,o.fL)("runeId").notNull().unique(),title:(0,o.fL)("title").notNull(),content:(0,o.fL)("content").notNull(),obtainMethods:(0,o.fL)("obtainMethods").notNull(),recommendedParty:(0,o.fL)("recommendedParty"),tips:(0,o.fL)("tips").notNull(),updatedAt:(0,r._L)("updatedAt",{mode:"timestamp"}).notNull()});let d=(0,a.Px)("GameServer",{id:(0,o.fL)("id").primaryKey(),game:(0,o.fL)("game").notNull(),name:(0,o.fL)("name").notNull(),status:(0,o.fL)("status").notNull(),population:(0,r._L)("population").notNull(),region:(0,o.fL)("region").notNull(),maintenanceMessage:(0,o.fL)("maintenanceMessage"),maintenanceEndTime:(0,o.fL)("maintenanceEndTime"),lastChecked:(0,r._L)("lastChecked",{mode:"timestamp"}).notNull(),createdAt:(0,r._L)("createdAt",{mode:"timestamp"}).notNull(),updatedAt:(0,r._L)("updatedAt",{mode:"timestamp"}).notNull()});(0,a.Px)("GameEvent",{id:(0,o.fL)("id").primaryKey(),game:(0,o.fL)("game").notNull(),title:(0,o.fL)("title").notNull(),description:(0,o.fL)("description").notNull(),startDate:(0,r._L)("startDate",{mode:"timestamp"}).notNull(),endDate:(0,r._L)("endDate",{mode:"timestamp"}).notNull(),imageUrl:(0,o.fL)("imageUrl"),url:(0,o.fL)("url"),rewards:(0,o.fL)("rewards"),isSpecial:(0,r._L)("isSpecial",{mode:"boolean"}).notNull().default(!1),category:(0,o.fL)("category").notNull(),createdAt:(0,r._L)("createdAt",{mode:"timestamp"}).notNull(),updatedAt:(0,r._L)("updatedAt",{mode:"timestamp"}).notNull()}),(0,i.lE)(u,({many:e})=>({comments:e(l,{relationName:"RuneToRuneComment"})})),(0,i.lE)(l,({one:e})=>({rune:e(u,{fields:[l.runeId],references:[u.id],relationName:"RuneToRuneComment"})}))}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),a=t.X(0,[948,972,838],()=>n(11278));module.exports=a})();