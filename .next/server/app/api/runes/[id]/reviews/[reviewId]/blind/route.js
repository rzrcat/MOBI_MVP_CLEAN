"use strict";(()=>{var e={};e.id=7,e.ids=[7],e.modules={72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},82424:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>m,patchFetch:()=>g,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>v,staticGenerationAsyncStorage:()=>x});var s={};t.r(s),t.d(s,{PUT:()=>l});var i=t(49303),n=t(88716),o=t(60670),a=t(20344),u=t(71615),d=t(87070);async function l(e,{params:r}){let t=(0,a.createRouteHandlerClient)({cookies:u.cookies}),{reviewId:s}=r,{data:i}=await t.auth.getSession();if(!i?.session?.user)return d.NextResponse.json({error:"Authentication required"},{status:401});let n=i.session.user.id;try{let{data:e}=await t.from("admin_roles").select("*").eq("user_id",n);if(!e||0===e.length)return d.NextResponse.json({error:"관리자 권한이 필요합니다."},{status:403});let{data:r}=await t.from("rune_reviews").select("is_blinded").eq("id",s).single();if(!r)return d.NextResponse.json({error:"한줄평을 찾을 수 없습니다."},{status:404});let i=!r.is_blinded,{data:o,error:a}=await t.from("rune_reviews").update({is_blinded:i}).eq("id",s).select(`
        id, 
        content, 
        created_at,
        likes,
        dislikes,
        is_blinded,
        users:user_id (
          id,
          full_name,
          avatar_url
        )
      `).single();if(a)return console.error("Error toggling rune review blind status:",a),d.NextResponse.json({error:a.message},{status:500});let u=o.users;return d.NextResponse.json({id:o.id,content:o.content,author:Array.isArray(u)?{id:u[0]?.id,name:u[0]?.full_name||"익명 사용자",avatar:u[0]?.avatar_url}:{id:u?.id,name:u?.full_name||"익명 사용자",avatar:u?.avatar_url},createdAt:o.created_at,likes:o.likes||0,dislikes:o.dislikes||0,isBlinded:o.is_blinded})}catch(e){return console.error("Unexpected error in rune review blind toggle:",e),d.NextResponse.json({error:"Server error occurred"},{status:500})}}let p=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/runes/[id]/reviews/[reviewId]/blind/route",pathname:"/api/runes/[id]/reviews/[reviewId]/blind",filename:"route",bundlePath:"app/api/runes/[id]/reviews/[reviewId]/blind/route"},resolvedPagePath:"/Users/s/Desktop/dev/mobi.gg/src/app/api/runes/[id]/reviews/[reviewId]/blind/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:c,staticGenerationAsyncStorage:x,serverHooks:v}=p,m="/api/runes/[id]/reviews/[reviewId]/blind/route";function g(){return(0,o.patchFetch)({serverHooks:v,staticGenerationAsyncStorage:x})}}};var r=require("../../../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[948,972,518,958],()=>t(82424));module.exports=s})();