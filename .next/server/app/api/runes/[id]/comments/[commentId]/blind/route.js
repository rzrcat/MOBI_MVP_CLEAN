"use strict";(()=>{var e={};e.id=261,e.ids=[261],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},98216:e=>{e.exports=require("net")},68621:e=>{e.exports=require("punycode")},76162:e=>{e.exports=require("stream")},82452:e=>{e.exports=require("tls")},17360:e=>{e.exports=require("url")},71568:e=>{e.exports=require("zlib")},59508:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>x,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>_,staticGenerationAsyncStorage:()=>l});var n={};r.r(n),r.d(n,{PUT:()=>m});var s=r(49303),i=r(88716),o=r(60670),a=r(87070),u=r(83603),d=r(42633);async function m(e,{params:t}){try{let e=await (0,u.I)();if(!e||!e.user.isAdmin)return a.NextResponse.json({error:"관리자 권한이 필요합니다."},{status:403});if(!await d.db.runeComment.findUnique({where:{id:t.commentId}}))return a.NextResponse.json({error:"코멘트를 찾을 수 없습니다."},{status:404});let r=await d.db.runeComment.update({where:{id:t.commentId},data:{isBlinded:!0}});return a.NextResponse.json(r)}catch(e){return console.error("Error blinding comment:",e),a.NextResponse.json({error:"코멘트 블라인드 처리 중 오류가 발생했습니다."},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/runes/[id]/comments/[commentId]/blind/route",pathname:"/api/runes/[id]/comments/[commentId]/blind",filename:"route",bundlePath:"app/api/runes/[id]/comments/[commentId]/blind/route"},resolvedPagePath:"/Users/s/Desktop/dev/mobi.gg/src/app/api/runes/[id]/comments/[commentId]/blind/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:p,staticGenerationAsyncStorage:l,serverHooks:_}=c,x="/api/runes/[id]/comments/[commentId]/blind/route";function f(){return(0,o.patchFetch)({serverHooks:_,staticGenerationAsyncStorage:l})}},83603:(e,t,r)=>{r.d(t,{I:()=>s});var n=r(36534);let s=async()=>{try{let{data:e,error:t}=await n.O.auth.getSession();if(t||!e.session)return null;return{user:{id:e.session.user.id,name:e.session.user.user_metadata?.name||e.session.user.email?.split("@")[0]||"익명",email:e.session.user.email,isAdmin:e.session.user.email?.endsWith("@admin.com")||!1}}}catch(e){return console.error("인증 처리 오류:",e),null}}},42633:(e,t,r)=>{r.d(t,{db:()=>s});var n=r(36534);let s={runeComment:{findMany:async({where:e,orderBy:t})=>{let{data:r,error:s}=await n.O.from("rune_comments").select("*").eq("runeId",e.runeId).order((t.createdAt,"created_at"),{ascending:"desc"!==t.createdAt});if(s)throw s;return r||[]},findUnique:async({where:e})=>{let{data:t,error:r}=await n.O.from("rune_comments").select("*").eq("id",e.id).single();return r?null:t},create:async({data:e})=>{let{data:t,error:r}=await n.O.from("rune_comments").insert([{rune_id:e.runeId,user_id:e.userId,user_name:e.userName,content:e.content,created_at:new Date().toISOString()}]).select().single();if(r)throw r;return t},update:async({where:e,data:t})=>{let{data:r,error:s}=await n.O.from("rune_comments").update({content:t.content,updated_at:t.updatedAt.toISOString()}).eq("id",e.id).select().single();if(s)throw s;return r},delete:async({where:e})=>{let{error:t}=await n.O.from("rune_comments").delete().eq("id",e.id);if(t)throw t;return!0}}}},36534:(e,t,r)=>{r.d(t,{O:()=>o});var n=r(31518);let s=process.env.NEXT_PUBLIC_SUPABASE_URL||"https://example.com",i=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"temp-key";process.env.NEXT_PUBLIC_SUPABASE_URL&&process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||console.warn("Missing Supabase environment variables. Using dummy client.");let o=(0,n.eI)(s,i)}};var t=require("../../../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),n=t.X(0,[948,972,518],()=>r(59508));module.exports=n})();